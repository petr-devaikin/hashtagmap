<!doctype html>
<html>
    <head>
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />
        <title>Hashtag Map</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}">
    </head>
    <body>
        <div id="main_container">
            <div id="map_container"></div>
            <canvas id="test_canvas" width="100%"></canvas>
            
            {% for group in groups %}
                <div class="tag_area" 
                        area-id="{{ group.id }}"
                        north="{{ group.north }}"
                        south="{{ group.south }}"
                        west="{{ group.west }}"
                        east="{{ group.east }}"
                        count="{{ group.normal_count() }}" 
                        radius="{{ group.radius }}"
                        tag="{{ group.tag }}"
                        title="{{ group.tag }}"
                        >
                    <canvas id="canvas_{{ group.id }}"></canvas>
                </div>
            {% endfor %}
        </div>
        <div id="header">
            <span id="info_button">info</span>
            <div>
                <h1><a href="{{ url_for('htm_app.index') }}">Hashtag Map</a></h1>
            </div>

            <div id="cities">
                {% for l in location_list %}
                    {% if l.id == location.id %}
                        <div class="city active">
                            {{ l.name }}
                        </div>
                    {% else %}
                        <div class="city">
                            <a href="{{ url_for('htm_app.index', location_name=l.name) }}">{{ l.name }}</a>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
        <div id="info_block">
            <h2>Hashtag Map v. 1.0</h2>
            &copy; 2014 Petr Devaikin<br/>
            E-mail: <a href="mailto:p.devaikin@gmail.com">p.devaikin@gmail.com</a>

            <h2>Last Update</h2>
            {{ location.updated }} ({{ location.timezone }})

            <h2>Ignored Hashtags</h2>
            {% for tag in ignore_list %}
                {{ tag }}{% if not loop.last %},{% endif %}
            {% endfor %}
        </div>

        <script>
            var maximum_count = {{ max_count }};
            var lat_km = {{ lat_km }};
            var long_km = {{ long_km }};
            var map_key = "{{ map_key }}";

            var location_name = "{{ location.name }}";

            var MIN_LATITUDE = {{ location.south }};
            var MAX_LATITUDE = {{ location.north }};

            var MIN_LONGITUDE = {{ location.west }};
            var MAX_LONGITUDE = {{ location.east }};
        </script>
        <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="{{ url_for('static', filename='js/canvas_helpers.js') }}"></script>
        <script src="{{ url_for('static', filename='js/map.js') }}"></script>
        <script src="{{ url_for('static', filename='js/hashtag_group.js') }}"></script>
        <script src="{{ url_for('static', filename='js/tags.js') }}"></script>
        <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    </body>
</html>
